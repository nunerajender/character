/*
  TYPOGRAPHY sass mixin
  Inspired by Medium.com, based on normalize.css & typebase.scss
  https://raw.githubusercontent.com/devinhunt/typebase.css/master/src/typebase.scss

  Usage:

  @include typography( rgba(0,0,0,0.8), // base font color
                       #222,            // links color
                       'Georgia',       // base font family
                       'Myriad Pro',    // header font family
                       'Monaco',        // code
                       20,              // base font size
                       1.5,             // base line height
                       0.33 * 7.3,      // h1 size
                       0.33 * 4.3,      // h2 size
                       0.33 * 3.3       // h3 size
                     );
*/

@mixin headerSize($fontSize, $baseLineHeight) {
  $lineHeight: ceil(100 * $baseLineHeight * ceil($fontSize / $baseLineHeight) / $fontSize);
  $margin: $lineHeight / 100;
                                        font-size: $fontSize * 1em;
                                        line-height: $lineHeight * 1%;
                                        margin-top: $margin * 1em;
                                        margin-bottom: $margin * 1em;
                                        word-break: normal;
}

// TODO: test for other browsers
@mixin mediumLinkUnderline($color)    { color: $color;
                                        background-clip: border-box;
                                        background-image: linear-gradient(rgb(255, 255, 255) 50%, $color 50%);
                                        background-position: 0 1em;
                                        background-repeat: repeat-x;
                                        background-size: 2px 2px;
                                        text-decoration: none;
                                        word-break: break-all;
}

@mixin mediumHorizontalRule($color)   { position: relative;
                                        left: 50%;
                                        width: 4em;
                                        margin: 2.25em 0 2.25em -2em;
                                        border-top-style: solid;
                                        border-top-color: $color;
                                        border-left-width: 0px;
                                        border-right-width: 0px;
                                        border-bottom-width: 0px;
}

@mixin typography( $baseColor:        rgba(0,0,0,0.8),
                   $linkColor:        #222,
                   $baseFontFamily:   'Georgia',
                   $headerFontFamily: 'Myriad Pro',
                   $codeFontFamily:   'Monaco',
                   $baseFontSize:     20,
                   $baseLineHeight:   1.5,
                   $h1:               0.33 * 7.3,
                   $h2:               0.33 * 4.3,
                   $h3:               0.33 * 3.3 ) {

  $leading: $baseLineHeight * 1em;

  /* Container font settings */
                                        font-family: $baseFontFamily;
                                        font-size: $baseFontSize * 1px;
                                        color: $baseColor;
                                        letter-spacing: 0.02em;

  /* Copy & Lists */
  p                                   { line-height: $leading;
                                        margin-top: $leading;
                                        margin-bottom: $leading;
  }

  /* First passage after h3 */
  h3 + p                              { margin-top: 0; }

  ul, ol                              { margin-top: $leading;
                                        margin-bottom: $leading;
    li                                { line-height: $leading; }
    ul, ol                            { margin-top: 0;
                                        margin-bottom: 0;
    }
  }
  blockquote                          { line-height: $leading;
                                        margin-top: $leading;
                                        margin-bottom: $leading;
                                        font-style: italic;
                                        text-align: center;
  }

  /* Headings */
  h1, h2, h3                          { /* Change heading typefaces here */
                                        font-family: $headerFontFamily;
                                        line-height: $leading;
                                        letter-spacing: 0em;
  }
  h1                                  { @include headerSize($h1, $baseLineHeight);
                                        margin-bottom: 0;
  }
  h2                                  { @include headerSize($h2, $baseLineHeight); }
  h3                                  { @include headerSize($h3, $baseLineHeight);
                                        margin-bottom: 0;
  }

  /* Images */
  img                                 { max-width: 100%; }

  /* Links */
  a                                   { @include mediumLinkUnderline($linkColor);
  }

  /* Horizontal Rule */
  hr                                  { @include mediumHorizontalRule(lighten($baseColor, 80%));
  }

  /* Tables */
  table                               { margin-top: $leading;
                                        border-spacing: 0px;
                                        border-collapse: collapse;
  }
  td, th                              { padding: 0;
                                        line-height: $baseLineHeight * $baseFontSize - 0px;
  }

  /* Code blocks */
  code                                { // Forces text to constrain to the line-height.
                                        // Not ideal, but works.
                                        vertical-align: bottom;
  }

  pre                                 { font-family: $codeFontFamily;
                                        font-size: .7em;
                                        line-height: $leading;
                                        margin-top: 0;
                                        margin-bottom: 0;
                                        padding: 1em 1.25em;
                                        vertical-align: bottom;
  }
}